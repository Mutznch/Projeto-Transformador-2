--- LOG INICIADO: ./training_output\training_log.txt ---
Carregando DataFrames de Treino (Raw Augmented), Validação e Teste...
Total Original (Raw): 16020, Total Aumentado (Raw): 236020
  -> Offline-Module: Added 11338 Augmented (Total: 12000)
  -> No-Anomaly: Added 1990 Augmented (Total: 10000)
  -> Shadowing: Added 11155 Augmented (Total: 12000)
  -> Diode: Added 8799 Augmented (Total: 10000)
  -> Cracking: Added 11247 Augmented (Total: 12000)
  -> Cell: Added 13497 Augmented (Total: 15000)
  -> Cell-Multi: Added 18969 Augmented (Total: 20000)
  -> Vegetation: Added 10687 Augmented (Total: 12000)
  -> Soiling: Added 19836 Augmented (Total: 20000)
  -> Diode-Multi: Added 11859 Augmented (Total: 12000)
  -> Hot-Spot: Added 14801 Augmented (Total: 15000)
  -> Hot-Spot-Multi: Added 15802 Augmented (Total: 16000)

Total de Amostras de Treino FINAL (Após Equalização): 166000
Distribuição Final de Classes de Treino:
anomaly_class
Soiling           20000
Cell-Multi        20000
Hot-Spot-Multi    16000
Cell              15000
Hot-Spot          15000
Cracking          12000
Shadowing         12000
Offline-Module    12000
Vegetation        12000
Diode-Multi       12000
Diode             10000
No-Anomaly        10000
Name: count, dtype: int64
Total classes: 12. Train samples (Final): 166000, Val samples: 1980, Test samples: 2000
Pesos de Classe Aplicados (na ordem do LabelEncoder): [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

Iniciando extração e escrita batch-wise para train (Total: 166000)...
  -> Modelo ResNet | Feature Size: 2048
  -> Modelo ViT | Feature Size: 768
  -> Modelo MobileNetV2 | Feature Size: 1280
  -> Modelo AlexNet | Feature Size: 9216

Concatenando features (Input Size: 13312)...
Ensemble features salvas com sucesso em: ./training_output\feature_cache\features_train_ALL_ENSEMBLE.npy

Iniciando extração e escrita batch-wise para val (Total: 1980)...
  -> Modelo ResNet | Feature Size: 2048
  -> Modelo ViT | Feature Size: 768
  -> Modelo MobileNetV2 | Feature Size: 1280
  -> Modelo AlexNet | Feature Size: 9216

Concatenando features (Input Size: 13312)...
Ensemble features salvas com sucesso em: ./training_output\feature_cache\features_val_ALL_ENSEMBLE.npy

Iniciando extração e escrita batch-wise para test (Total: 2000)...
  -> Modelo ResNet | Feature Size: 2048
  -> Modelo ViT | Feature Size: 768
  -> Modelo MobileNetV2 | Feature Size: 1280
  -> Modelo AlexNet | Feature Size: 9216

Concatenando features (Input Size: 13312)...
Ensemble features salvas com sucesso em: ./training_output\feature_cache\features_test_ALL_ENSEMBLE.npy
INPUT_SIZE (Features Ensemble): 13312

==================================================
INICIANDO TREINAMENTO DO CLASSIFICADOR (ALL classes)
==================================================
Epoch 1/400 | Train Loss: 2.2571 | Val Loss: 1.0553 | LR: 0.000100
Epoch 2/400 | Train Loss: 2.1738 | Val Loss: 0.9562 | LR: 0.000100
Epoch 3/400 | Train Loss: 2.1433 | Val Loss: 0.9012 | LR: 0.000100
Epoch 4/400 | Train Loss: 2.1210 | Val Loss: 0.8788 | LR: 0.000100
Epoch 5/400 | Train Loss: 2.1041 | Val Loss: 0.8235 | LR: 0.000100
Epoch 6/400 | Train Loss: 2.0923 | Val Loss: 0.8236 | LR: 0.000100
Epoch 7/400 | Train Loss: 2.0795 | Val Loss: 0.7852 | LR: 0.000100
Epoch 8/400 | Train Loss: 2.0683 | Val Loss: 0.8020 | LR: 0.000100
Epoch 9/400 | Train Loss: 2.0620 | Val Loss: 0.7527 | LR: 0.000100
Epoch 10/400 | Train Loss: 2.0535 | Val Loss: 0.7379 | LR: 0.000100
Epoch 11/400 | Train Loss: 2.0456 | Val Loss: 0.7217 | LR: 0.000100
Epoch 12/400 | Train Loss: 2.0400 | Val Loss: 0.6898 | LR: 0.000100
Epoch 13/400 | Train Loss: 2.0327 | Val Loss: 0.7024 | LR: 0.000100
Epoch 14/400 | Train Loss: 2.0278 | Val Loss: 0.6705 | LR: 0.000100
Epoch 15/400 | Train Loss: 2.0220 | Val Loss: 0.6812 | LR: 0.000100
Epoch 16/400 | Train Loss: 2.0173 | Val Loss: 0.7358 | LR: 0.000100
Epoch 17/400 | Train Loss: 2.0122 | Val Loss: 0.7032 | LR: 0.000100
Epoch 18/400 | Train Loss: 2.0089 | Val Loss: 0.6744 | LR: 0.000100
Epoch 19/400 | Train Loss: 2.0041 | Val Loss: 0.6776 | LR: 0.000100
Epoch 20/400 | Train Loss: 2.0002 | Val Loss: 0.6592 | LR: 0.000100
Epoch 21/400 | Train Loss: 1.9977 | Val Loss: 0.7342 | LR: 0.000100
Epoch 22/400 | Train Loss: 1.9943 | Val Loss: 0.6553 | LR: 0.000100
Epoch 23/400 | Train Loss: 1.9908 | Val Loss: 0.6515 | LR: 0.000100
Epoch 24/400 | Train Loss: 1.9883 | Val Loss: 0.6731 | LR: 0.000100
Epoch 25/400 | Train Loss: 1.9844 | Val Loss: 0.6539 | LR: 0.000100
Epoch 26/400 | Train Loss: 1.9815 | Val Loss: 0.6494 | LR: 0.000100
Epoch 27/400 | Train Loss: 1.9793 | Val Loss: 0.6549 | LR: 0.000100
Epoch 28/400 | Train Loss: 1.9765 | Val Loss: 0.6511 | LR: 0.000100
Epoch 29/400 | Train Loss: 1.9734 | Val Loss: 0.6592 | LR: 0.000100
Epoch 30/400 | Train Loss: 1.9712 | Val Loss: 0.7160 | LR: 0.000100
Epoch 31/400 | Train Loss: 1.9688 | Val Loss: 0.7714 | LR: 0.000100
Epoch 32/400 | Train Loss: 1.9668 | Val Loss: 0.6760 | LR: 0.000100
Epoch 33/400 | Train Loss: 1.9657 | Val Loss: 0.6647 | LR: 0.000100
Epoch 34/400 | Train Loss: 1.9635 | Val Loss: 0.6695 | LR: 0.000050
Epoch 35/400 | Train Loss: 1.9492 | Val Loss: 0.6568 | LR: 0.000050
Epoch 36/400 | Train Loss: 1.9429 | Val Loss: 0.6801 | LR: 0.000050
Epoch 37/400 | Train Loss: 1.9404 | Val Loss: 0.7144 | LR: 0.000050
Epoch 38/400 | Train Loss: 1.9371 | Val Loss: 0.7144 | LR: 0.000050
Epoch 39/400 | Train Loss: 1.9359 | Val Loss: 0.7239 | LR: 0.000050
Epoch 40/400 | Train Loss: 1.9339 | Val Loss: 0.7379 | LR: 0.000050
Epoch 41/400 | Train Loss: 1.9341 | Val Loss: 0.6923 | LR: 0.000050
Epoch 42/400 | Train Loss: 1.9312 | Val Loss: 0.7455 | LR: 0.000025
Epoch 43/400 | Train Loss: 1.9250 | Val Loss: 0.7583 | LR: 0.000025
Epoch 44/400 | Train Loss: 1.9219 | Val Loss: 0.7438 | LR: 0.000025
Epoch 45/400 | Train Loss: 1.9204 | Val Loss: 0.7713 | LR: 0.000025

[Early Stopping] Parando na Época 46 após 20 épocas sem melhora.

Training finished.

==================================================
CLASSIFICATION RESULTS (ALL classes)
==================================================
Overall Accuracy: 0.8195

Detailed Classification Report:
                precision    recall  f1-score   support

          Cell       0.65      0.69      0.67       188
    Cell-Multi       0.48      0.46      0.47       129
      Cracking       0.72      0.66      0.69        94
         Diode       0.91      0.96      0.94       150
   Diode-Multi       0.91      0.59      0.71        17
      Hot-Spot       0.72      0.52      0.60        25
Hot-Spot-Multi       0.55      0.46      0.50        24
    No-Anomaly       0.92      0.96      0.94      1000
Offline-Module       0.77      0.66      0.71        83
     Shadowing       0.81      0.73      0.77       106
       Soiling       0.37      0.35      0.36        20
    Vegetation       0.71      0.67      0.69       164

      accuracy                           0.82      2000
     macro avg       0.71      0.64      0.67      2000
  weighted avg       0.81      0.82      0.82      2000

Matriz de Confusão Sem Normalização

Matriz salva em: ./augmented_data_output\confusion_matrix_raw_ALL.png
Matriz de Confusão Normalizada

Matriz salva em: ./augmented_data_output\confusion_matrix_normalized_ALL.png

Final DNN model salvo como: ultradeep_dnn_ALL_aug.pth
